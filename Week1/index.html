<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Titanic Ultra — 2025 EDA Dashboard (ECharts)</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net"/>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <style>
    :root{
      --bg:#0b0f17; --bg2:#0e1320; --panel:#0f1524; --ink:#e9edf6; --muted:#a7b0c3;
      --brand:#7ee787; --brand2:#8aa3ff; --hot:#ff7a90; --cold:#43c6ff; --glass:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.12);
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{min-height:100vh;color:var(--ink);background:
      radial-gradient(1200px 700px at 10% -10%, #1a2b47 0%, var(--bg) 60%),
      radial-gradient(800px 500px at 120% 10%, #222a44 0%, var(--bg2) 60%),
      linear-gradient(180deg,#090f1a, var(--bg2));
      padding:26px; font-family:Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif}
    .wrap{max-width:1280px;margin:0 auto}

    .header{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-bottom:18px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:46px;height:46px;border-radius:14px;background:
      conic-gradient(from 180deg at 50% 50%, var(--brand), var(--brand2), var(--cold), var(--hot), var(--brand));
      filter: drop-shadow(0 12px 30px rgba(0,0,0,.45));}
    .title h1{font-size:clamp(1.5rem,2.8vw,2.2rem);line-height:1.1}
    .title p{color:var(--muted);margin-top:6px}

    .toolbar{display:flex;gap:10px;flex-wrap:wrap}
    select,button{background:var(--glass);color:var(--ink);border:1px solid var(--border);
      padding:9px 12px;border-radius:12px;cursor:pointer;backdrop-filter: blur(6px)}
    .link{color:#9dd2ff;text-decoration:none}

    .panel{background:linear-gradient(180deg, var(--panel), #0b1222);
      border:1px solid var(--border);border-radius:22px;padding:18px;box-shadow:0 20px 45px rgba(0,0,0,.35)}
    .grid{display:grid;gap:14px}
    .cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    @media(max-width:980px){.cols-3,.cols-2{grid-template-columns:1fr}}

    .kpi{background:var(--glass);border:1px solid var(--border);border-radius:16px;padding:14px 16px}
    .kpi .label{color:var(--muted);font-size:.9rem}
    .kpi .value{font-size:1.8rem;font-weight:800;margin-top:6px;background:linear-gradient(90deg,var(--brand),var(--brand2));-webkit-background-clip:text;background-clip:text;color:transparent}

    .chips{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .chip{background:rgba(255,255,255,.08);border:1px solid var(--border);padding:6px 10px;border-radius:999px;font-size:.9rem;color:var(--muted)}

    .card{background:rgba(255,255,255,.06);border:1px solid var(--border);border-radius:16px;padding:14px}
    .card h3{font-size:1.06rem;margin-bottom:8px}
    .chart{height:330px}
    .small{height:260px}

    .footer{text-align:center;color:var(--muted);margin-top:22px;font-size:.9rem}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="brand">
        <div class="logo"></div>
        <div class="title">
          <h1>Titanic Ultra — EDA Dashboard (2025)</h1>
          <p>Client‑side EDA powered by <b>ECharts 5</b> + <b>PapaParse</b>. Fluid layout, pro visuals, one‑file deploy.</p>
        </div>
      </div>
      <div class="toolbar">
        <label>Sex
          <select id="fSex">
            <option value="ALL" selected>All</option>
            <option value="female">Female</option>
            <option value="male">Male</option>
          </select>
        </label>
        <label>Pclass
          <select id="fClass">
            <option value="ALL" selected>All</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
          </select>
        </label>
        <label>Embarked
          <select id="fEmb">
            <option value="ALL" selected>All</option>
            <option value="C">C</option>
            <option value="Q">Q</option>
            <option value="S">S</option>
            <option value="UNKNOWN">Unknown</option>
          </select>
        </label>
        <button id="dlBtn">Download filtered CSV</button>
      </div>
    </div>

    <!-- KPIs -->
    <div class="panel">
      <div class="grid cols-3">
        <div class="kpi"><div class="label">Rows (train.csv)</div><div class="value" id="kRows">—</div></div>
        <div class="kpi"><div class="label">Overall Survival</div><div class="value" id="kSurv">—</div></div>
        <div class="kpi"><div class="label">Median Age / Fare</div><div class="value"><span id="kAge">—</span> / <span id="kFare">—</span></div></div>
      </div>
      <div class="chips">
        <div class="chip">Female survival: <b id="cFem">—</b></div>
        <div class="chip">Male survival: <b id="cMale">—</b></div>
        <div class="chip">Δ Gender: <b id="cDeltaG">—</b></div>
        <div class="chip">Δ Class (1st–3rd): <b id="cDeltaC">—</b></div>
      </div>
    </div>

    <!-- Charts -->
    <div class="grid cols-2" style="margin-top:14px">
      <div class="card"><h3>Survival Gauge</h3><div id="chGauge" class="chart small"></div></div>
      <div class="card"><h3>Gender (Diverging %)</h3><div id="chGender" class="chart"></div></div>
      <div class="card"><h3>Pclass (100% stacked)</h3><div id="chClassPct" class="chart"></div></div>
      <div class="card"><h3>Sex → Class → Outcome (Sankey)</h3><div id="chSankey" class="chart"></div></div>
      <div class="card"><h3>Age (Boxplot + points)</h3><div id="chAgeBox" class="chart"></div></div>
      <div class="card"><h3>Fare × Age (Scatter + regression)</h3><div id="chScatter" class="chart"></div></div>
      <div class="card"><h3>Embarked (100% stacked)</h3><div id="chEmb" class="chart small"></div></div>
      <div class="card"><h3>Correlation (numeric)</h3><div id="
